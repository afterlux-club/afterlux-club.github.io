<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RN07E4K7GL"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-RN07E4K7GL');
</script>
<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Afterlux Club — Events & Reservierungen</title>
<link rel="icon" type="image/png" href="afterluxluna.png" />

<meta property="og:title" content="Afterlux Club – Events & Reservierungen">
<meta property="og:description" content="Entdecke die nächsten Events und reserviere deine Lounge in Lörrach.">
<meta property="og:image" content="afterluxluna.png">
<meta property="og:type" content="website">

<meta name="color-scheme" content="dark" />
<style>
  :root{
    --gold:#FFD700; --gold-d:#e6c200;
    --text:#fff; --muted:#bbbbbb;
    --card:rgba(255,255,255,.06);
    --border:rgba(255,255,255,.18);
    --radius:16px;
  }
  *{box-sizing:border-box}
  html,body{margin:0}
  body{
    font-family: Helvetica, Arial, sans-serif;
    color:var(--text);
    background:
      linear-gradient(rgba(0,0,0,.62), rgba(0,0,0,.72)),
      url("sfondo%20web.png") center/cover fixed no-repeat #000;
    min-height:100vh;
    line-height:1.45;
    padding-top:var(--toppad, 160px);
  }
  a{color:var(--gold);text-decoration:none}
  a:hover{text-decoration:underline}
  header, section, footer{padding:22px}
  h1,h2,h3{color:#fff;margin:0 0 12px}
  .container{max-width:1100px;margin:0 auto}

  /* ======== HEADER FISSO TRASPARENTE ======== */
  .topbar{
    position:fixed; top:0; left:0; right:0; z-index:92;
    background:transparent;
    border-bottom:1px solid transparent;
    padding: env(safe-area-inset-top) 16px 10px;
    pointer-events:auto;
  }
  .topbar.scrolled{ background:transparent; border-bottom-color:transparent; }
  .topbar .row{ display:flex; align-items:center; justify-content:center; gap:12px; max-width:1100px; margin:0 auto; }
  .hamburger{
    position:absolute; left:14px; top:calc(8px + env(safe-area-inset-top));
    width:42px; height:42px; border-radius:12px;
    display:grid; place-items:center; cursor:pointer;
    border:1px solid var(--border); background:rgba(0,0,0,.35); backdrop-filter: blur(4px);
  }
  .hamburger span{display:block;width:20px;height:2px;background:#fff;position:relative}
  .hamburger span::before,.hamburger span::after{content:"";position:absolute;left:0;width:100%;height:2px;background:#fff}
  .hamburger span::before{top:-6px}.hamburger span::after{top:6px}
  .logo-wrap{display:flex;justify-content:center;align-items:center}
  /* LOGO raddoppiato (+100% rispetto alla versione precedente) */
  .logo{ height: clamp(192px, 38.4vw, 432px); max-width:100%; display:block; margin:0 auto; object-fit:contain; }

  /* Drawer menù */
  .drawer{position:fixed; inset:0; z-index:93; display:none}
  .drawer.show{display:block}
  .drawer .shade{position:absolute;inset:0;background:rgba(0,0,0,.6)}
  .drawer .panel{
    position:absolute; top:0; left:0; bottom:0; width:min(82vw,340px);
    background:#0b0b0b; border-right:1px solid var(--border);
    padding:16px; overflow:auto;
  }
  .drawer a{display:block;padding:14px 10px;border-radius:10px;color:#fff}
  .drawer a:hover{background:rgba(255,255,255,.08)}

  /* BTN */
  .btn{display:inline-block;background:var(--gold);color:#000;padding:12px 18px;border-radius:14px;border:none;font-weight:700;cursor:pointer}
  .btn:hover{background:var(--gold-d)}
  .ghost{background:transparent;color:#fff;border:1px solid var(--border)}

  /* CARDS */
  .cards{display:grid;gap:18px;grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
  .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden}
  .card img,.card video{ width:100%;height:clamp(220px,32vw,420px);object-fit:cover;display:block;background:#000 }
  .card .content{padding:14px}
  .pill{display:inline-block;padding:4px 10px;border-radius:999px;background:rgba(255,255,255,.10);font-size:12px;margin-bottom:8px;color:#fff}
  .muted{color:var(--muted)}

  /* MAP */
  .map{width:100%;height:300px;border:0;border-radius:12px}

  /* MODAL */
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,.72);display:none;align-items:center;justify-content:center;padding:16px;z-index:90}
  .overlay.show{display:flex}
  .modal{max-width:900px;width:100%;background:#0a0a0a;border:1px solid var(--border);border-radius:16px;overflow:hidden}
  .modal-head,.modal-foot{padding:12px 14px;border-bottom:1px solid var(--border)}
  .modal-foot{border-top:1px solid var(--border);border-bottom:none;display:flex;justify-content:flex-end;gap:10px;flex-wrap:wrap}
  .modal-body{display:grid;grid-template-columns:1fr 1fr;gap:14px;padding:14px}
  .modal .cover{height:260px;background:#111 center/cover no-repeat;border:1px solid var(--border);border-radius:12px}
  @media (max-width:800px){.modal-body{grid-template-columns:1fr}}

  footer{border-top:1px solid var(--border);text-align:center;color:var(--muted);padding-bottom:72px}

  /* Prenotazioni nascosta all'avvio */
  #prenotazioni{display:none !important;}

  /* CONTATTI COLLASSABILI */
  #contatti .content-wrapper{display:none;margin-top:12px}
  #contatti.open .content-wrapper{display:block}
  #contatti h2{display:flex;align-items:center;gap:10px;cursor:pointer}
  #contatti .chev{transition:transform .2s ease;display:inline-block}
  #contatti.open .chev{transform:rotate(90deg)}

  /* ===== Barra inferiore: ORA TRASPARENTE + ICONE PIÙ PICCOLE ===== */
  .dock{
    position:fixed;left:0;right:0;bottom:0;z-index:91;
    background:transparent;                 /* <<< trasparente */
    padding:4px 8px;                        /* un po' più compatta */
    display:flex;gap:8px;justify-content:space-around;align-items:center;
    pointer-events:auto;
  }
  .dock .ico{
    width:32px; height:32px;                /* <<< icone più piccole (prima 44px) */
    border-radius:999px; border:2px solid #fff;
    display:grid; place-items:center; color:#fff;
    background:transparent;
  }
  .dock svg{ width:16px; height:16px; fill:#fff } /* <<< svg più piccoli (prima 20px) */

  /* Lounge & Promoter grandi come card */
  .wide-img{
    width:100%;height:clamp(220px,32vw,420px);
    object-fit:cover;display:block;margin:0 auto 20px;border-radius:12px;
    box-shadow:0 0 20px rgba(255,255,255,.2)
  }
</style>
</head>
<body>

<!-- ======= TOPBAR FISSA TRASPARENTE ======= -->
<div class="topbar" id="topbar">
  <div class="row">
    <button class="hamburger" id="open-menu" aria-label="Menü öffnen"><span></span></button>
    <div class="logo-wrap">
      <img src="afterluxluna.png" alt="Afterlux Club Logo" class="logo" id="main-logo" loading="eager" decoding="async">
    </div>
  </div>
</div>

<!-- Drawer/Hamburger Menu -->
<div class="drawer" id="drawer" aria-hidden="true">
  <div class="shade" id="drawer-close" aria-label="Schließen"></div>
  <nav class="panel" aria-label="Seitennavigation">
    <h3 style="margin-top:6px;color:#fff">Menü</h3>
    <a href="#eventi" onclick="hideDrawer()">Events</a>
    <a href="#galleria" onclick="hideDrawer()">Galerie</a>
    <a href="#chi-siamo" onclick="hideDrawer()">Über uns</a>
    <a href="#contatti" onclick="hideDrawer(); openContatti()">Kontakt</a>
  </nav>
</div>

<header class="container" style="padding-top:8px">
  <div id="countdown" class="container" hidden style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-top:6px">
    <span class="pill"><b id="cd-d">--</b> Tage</span>
    <span class="pill"><b id="cd-h">--</b> Std</span>
    <span class="pill"><b id="cd-m">--</b> Min</span>
    <span class="pill"><b id="cd-s">--</b> Sek</span>
  </div>
</header>

<main class="container">
  <!-- HERO -->
  <section>
    <h1 style="font-size:clamp(28px,6.8vw,56px);line-height:1.1;color:#fff;margin-top:6px">
      THE ORIGINAL NIGHT<br>EXPERIENCE IN<br>LÖRRACH — AFTERLUX
    </h1>
    <p style="font-size:clamp(16px,3.6vw,22px);color:#ddd;max-width:900px">
      House, Hip-Hop, Reggaeton & mehr: moderne Party-Vibes mit goldener Eleganz – für Nächte, die in Erinnerung bleiben.
    </p>
    <div style="display:flex;gap:14px;flex-wrap:wrap">
      <a class="btn" href="#eventi">Events ansehen</a>
      <a class="btn ghost" href="#chi-siamo">Mehr erfahren</a>
    </div>
  </section>

  <!-- EVENTS -->
  <section id="eventi" style="margin-top:26px">
    <h2 style="color:#fff">Kommende Events</h2>

    <div class="card" style="padding:12px;display:flex;gap:10px;flex-wrap:wrap;margin-bottom:16px">
      <input id="q" placeholder="Suchen… (z.B. Latin, Halloween)" aria-label="Events suchen"
            style="flex:1;min-width:200px;padding:10px;border-radius:10px;border:1px solid var(--border);background:#0b0b0b;color:#fff">
      <select id="month" aria-label="Nach Monat filtern"
              style="padding:10px;border-radius:10px;border:1px solid var(--border);background:#0b0b0b;color:#fff">
        <option value="">Alle Monate</option>
      </select>
      <button class="btn ghost" type="button" id="clr">Zurücksetzen</button>
    </div>

    <div id="event-cards" class="cards"></div>

    <h3 style="margin-top:26px;color:#fff">Wiederkehrende Events</h3>
    <div id="recurring-cards" class="cards"></div>
  </section>

  <!-- ÜBER UNS -->
  <section id="chi-siamo" style="margin-top:42px">
    <h2>Über uns</h2>
    <p><strong>Afterlux Club</strong> ist die Vision zweier junger Partner: <strong>Giuseppe Leocata</strong> und <strong>Luana Ferlito</strong>.</p>
    <p>Unsere Mission: Wir bringen das Nachtleben in Lörrach nach vorn – mit einem Ort, an dem sich <em>alle</em> wohlfühlen. Bei uns laufen verschiedene Musikrichtungen, von House und Hip-Hop über Reggaeton bis Tech House, in einer offenen, inklusiven Atmosphäre.</p>
    <p>Mit Motto-Nights, Shows und neuen Formaten schaffen wir regelmäßig frische, einzigartige Erlebnisse – damit jede Nacht in Erinnerung bleibt.</p>
  </section>

  <!-- GALERIE -->
  <section id="galleria">
    <h2>Galerie</h2>

    <img src="./Lounge-Afterlux.png" alt="Lounge-Plan Afterlux" class="wide-img" loading="lazy">
    <p style="color:#FFD700;text-align:center;margin-top:-8px">Reserviere deine Lounge: N1–N5 jedes Wochenende verfügbar.</p>

    <div class="cards" style="margin-top:18px">
      <article class="card">
        <video controls playsinline preload="metadata" poster="afterluxluna.png" loading="lazy"
              aria-label="Afterlux Club – Video Teaser"></video>
        <div class="content">
          <div class="pill">Highlight • Club Teaser</div>
          <h3 style="color:#fff">Afterlux – Video</h3>
          <p class="muted">Präsentation</p>
          <div style="margin-top:8px">
            <button class="btn" type="button"
              onclick="this.closest('.card').querySelector('video').play()">▶︎ Play</button>
            <button class="btn ghost" type="button"
              onclick="this.closest('.card').querySelector('video').pause()">⏸︎ Pause</button>
          </div>
        </div>
        <script>
          (function(){
            const v=document.currentScript.previousElementSibling.previousElementSibling;
            if(v && !v.querySelector('source')){
              const s=document.createElement('source');
              s.src='video%20afterlux%20.mp4'; s.type='video/mp4'; v.appendChild(s);
            }
          })();
        </script>
      </article>
    </div>

    <div class="promoter-section" style="text-align:center;margin-top:28px">
      <h3 style="color:#fff;font-size:1.8rem;margin-bottom:15px">Werde Afterlux Promoter</h3>
      <img src="./promoter.jpg" alt="Afterlux Club Promoter" class="wide-img" loading="lazy" style="max-width:1000px">
      <p style="color:#FFD700;font-size:1rem;max-width:800px;margin:8px auto 0">
        Du willst Teil vom Afterlux-Team werden? Schreib uns auf Instagram oder per E-Mail und sichere dir exklusive Vorteile.
      </p><br>
      <a href="https://www.instagram.com/afterlux_club/" target="_blank" rel="noopener"
        style="background-color:#FFD700;color:#000;padding:10px 25px;border-radius:25px;text-decoration:none;font-weight:bold">
        Kontaktiere uns auf Instagram
      </a>
    </div>
  </section>

  <!-- CONTATTI -->
  <section id="contatti" aria-expanded="false" style="margin-top:42px">
    <h2 tabindex="0" aria-controls="contatti-body" aria-label="Kontakt öffnen/schließen">
      <span class="chev">▶</span> Kontakt
      <span class="muted" style="font-size:12px">&nbsp;(klicken zum Anzeigen)</span>
    </h2>
    <div id="contatti-body" class="content-wrapper">
      <div class="cards">
        <div class="card"><div class="content">
          <p><strong>Telefon:</strong> <a href="tel:+4915738465393">+49 1573 8465393</a></p>
          <p><strong>E-Mail:</strong> <a href="mailto:afterlux.loerrach@gmail.com">afterlux.loerrach@gmail.com</a></p>
          <p><strong>Instagram:</strong> <a target="_blank" rel="noopener" href="https://www.instagram.com/afterlux_club?igsh=cWU0emo2ZHZyYjZp">@afterlux_club</a></p>
          <p><strong>Adresse:</strong> Teicherstrasse 14, 79539 Lörrach (DE)</p>
          <p class="muted">Öffnungszeiten: Mo–Mi geschlossen · Do 21:30–02:00 · Fr 23:00–05:00 · Sa 23:00–05:00 · So 14:00–18:00</p>
        </div></div>
        <div class="card">
          <iframe class="map" src="https://www.google.com/maps?q=Teicherstrasse%2014%2079539%20L%C3%B6rrach&output=embed" loading="lazy" allowfullscreen></iframe>
        </div>
      </div>
    </div>
  </section>

  <!-- PRENOTAZIONI -->
  <section id="prenotazioni">
    <h2>Reservieren</h2>
    <p class="muted">Schreib uns direkt: Event & Lounge wählen und dann per WhatsApp oder E-Mail senden.</p>

    <div class="card" style="padding:16px;display:grid;gap:12px">
      <div style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px">
        <label><div class="muted">Vor- und Nachname</div>
          <input id="pr-nome" type="text" placeholder="Dein Name"
            style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:#0b0b0b;color:#fff">
        </label>
        <label><div class="muted">Telefon</div>
          <input id="pr-tel" type="tel" placeholder="+49 ..."
            style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:#0b0b0b;color:#fff">
        </label>
      </div>

      <div style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px">
        <label><div class="muted">E-Mail</div>
          <input id="pr-email" type="email" placeholder="name@email.com"
            style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:#0b0b0b;color:#fff">
        </label>
        <label><div class="muted">Datum (bei datiertem Event)</div>
          <input id="pr-data" type="date"
            style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:#0b0b0b;color:#fff">
        </label>
      </div>

      <div style="display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:12px">
        <label><div class="muted">Event</div>
          <select id="pr-event" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:#0b0b0b;color:#fff">
            <option value="">— Event auswählen —</option>
          </select>
        </label>

        <label><div class="muted">Lounge</div>
          <select id="pr-lounge" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:#0b0b0b;color:#fff">
            <option>N0</option><option>N1</option><option>N2</option><option>N3</option><option>N4</option><option>N5</option>
          </select>
        </label>

        <label><div class="muted">Personen</div>
          <select id="pr-persone" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:#0b0b0b;color:#fff">
            <option>2</option><option>4</option><option>6</option><option>8</option><option>10</option>
          </select>
        </label>
      </div>

      <label><div class="muted">Notizen (optional)</div>
        <textarea id="pr-note" rows="3" placeholder="z. B. Geburtstag, Wünsche…"
          style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:#0b0b0b;color:#fff"></textarea>
      </label>

      <div style="display:flex;gap:10px;flex-wrap:wrap">
        <button class="btn" type="button" id="btn-wa">Per WhatsApp senden</button>
        <button class="btn ghost" type="button" id="btn-mail">Per E-Mail senden</button>
        <a class="btn ghost" href="tel:+4915738465393">Anrufen</a>
      </div>
    </div>
  </section>
</main>

<!-- MODAL EVENTI -->
<div id="event-detail" class="overlay" role="dialog" aria-modal="true" aria-labelledby="detail-title">
  <div class="modal">
    <div class="modal-head"><h3 id="detail-title" style="margin:0;color:#fff">Event-Details</h3></div>
    <div class="modal-body">
      <div id="detail-cover" class="cover" aria-label="Event-Cover"></div>
      <div>
        <div class="pill" id="detail-date">Datum</div>
        <h3 id="detail-name" style="margin:8px 0 6px;color:#fff">Titel</h3>
        <p class="muted" id="detail-desc">Beschreibung</p>
        <div style="margin-top:10px"><strong>Line-up</strong><div class="muted" id="detail-lineup">—</div></div>
        <div style="margin-top:10px"><strong>Info</strong><div class="muted" id="detail-prices">—</div></div>
      </div>
    </div>
    <div class="modal-foot">
      <button id="open-booking" class="btn" type="button">Jetzt reservieren</button>
      <button id="add-calendar" class="btn ghost" type="button">In den Kalender</button>
    </div>
  </div>
</div>

<footer><div class="container">© <span id="year"></span> Afterlux Club • Alle Rechte vorbehalten</div></footer>

<!-- DOCK INFERIORE (fissa, TRASPARENTE, senza telefono) -->
<div class="dock" aria-label="Schnellzugriff">
  <a class="ico" href="mailto:afterlux.loerrach@gmail.com" aria-label="E-Mail">
    <svg viewBox="0 0 24 24"><path d="M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"/></svg>
  </a>
  <a class="ico" href="https://www.instagram.com/afterlux_club/" target="_blank" rel="noopener" aria-label="Instagram">
    <svg viewBox="0 0 24 24"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm5 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm6.5-.25a1.25 1.25 0 1 0 0 2.5 1.25 1.25 0 0 0 0-2.5zM12 9a3 3 0 1 1 0 6 3 3 0 0 1 0-6z"/></svg>
  </a>
  <a class="ico" href="https://wa.me/4915738465393" target="_blank" rel="noopener" aria-label="WhatsApp">
    <svg viewBox="0 0 32 32"><path d="M19.11 17.44a5.52 5.52 0 0 1-2.45-.62 10.63 10.63 0 0 1-3.33-2.62 7.17 7.17 0 0 1-1.48-2.66 3 3 0 0 1 .1-1.87c.22-.51.79-.73 1.28-.54a1.78 1.78 0 0 1 .64.45c.26.27.53.55.74.86.23.33.27.71.1 1.09-.14.32-.32.63-.48.95-.14.28-.12.54.07.79a6.83 6.83 0 0 0 1.77 1.76c.25.19.52.21.81.07.32-.16.63-.34.95-.48.39-.17.77-.13 1.1.11.32.22.61.49.89.76.19.19.35.4.43.67.16.56-.11 1.11-.61 1.28-.53.18-1.07.31-1.62.31ZM16 3a13 13 0 0 0-11.3 19.5L3 29l6.68-1.75A13 13 0 1 0 16 3Zm0 23.6c-2.19 0-4.21-.66-5.9-1.8l-.42-.28-3.93 1.03 1.06-3.8-.29-.44A10.6 10.6 0 1 1 26.6 16c0 5.86-4.74 10.6-10.6 10.6Z"/></svg>
  </a>
</div>

<script>
  document.getElementById('year').textContent = new Date().getFullYear();

  /* Header fisso: padding dinamico */
  (function(){
    const topbar = document.getElementById('topbar');
    function setTopPad(){
      const h = topbar.offsetHeight;
      document.documentElement.style.setProperty('--toppad', h + 'px');
    }
    function onScroll(){
      if(window.scrollY > 8) topbar.classList.add('scrolled');
      else topbar.classList.remove('scrolled');
    }
    window.addEventListener('load', setTopPad, {once:true});
    window.addEventListener('resize', setTopPad);
    setTimeout(setTopPad, 120);
    window.addEventListener('scroll', onScroll);
    onScroll();
  })();

  /* Drawer */
  const drawer = document.getElementById('drawer');
  const openBtn = document.getElementById('open-menu');
  const closeShade = document.getElementById('drawer-close');
  function showDrawer(){ drawer.classList.add('show'); drawer.setAttribute('aria-hidden','false'); }
  function hideDrawer(){ drawer.classList.remove('show'); drawer.setAttribute('aria-hidden','true'); }
  openBtn.addEventListener('click', showDrawer);
  closeShade.addEventListener('click', hideDrawer);

  /* Eventi + resto JS (immutato) */
  const eventi = [
    { slug:'russian-beats-2025-10-11', name:'Russian Beats', dateISO:'2025-10-11T22:30:00+02:00', shortDate:'Sa 11 Okt', desc:'Beginn 22:30', lineup:'DJ Andy', prices:'—', cover:'serata russa 11.10.jpg' },
    { slug:'latin-night-2025-10-17', name:'Latin Night', dateISO:'2025-10-17T23:00:00+02:00', shortDate:'Fr 17 Okt', desc:'Start 23:00 • DJ Don-Maiky • Eintritt GRATIS', lineup:'DJ Don-Maiky', prices:'Eintritt GRATIS', cover:'Latin Night.jpg' },
    { slug:'rhythms-of-world-2025-10-18', name:'Rhythms of World', dateISO:'2025-10-18T23:00:00+02:00', shortDate:'Sa 18 Okt', desc:'Start 23:00', lineup:'David Costa', prices:'Eintritt GRATIS & ein GRATIS-SHOT', cover:'david costa 18.10.jpg' },
    { slug:'la-noche-brasilena-2025-10-25', name:'La noche brasileña', dateISO:'2025-10-25T23:00:00+02:00', shortDate:'Sa 25 Okt', desc:'Start 23:00', lineup:'Salese', prices:'Eintritt 5€ & ein GRATIS-SHOT', cover:'dj salese 25.10.jpg',
      ticketUrl:'https://eventfrog.de/de/p/party/disco/la-noche-brasilena-7381417087799956339.html' },
    { slug:'halloween-party-2025-10-31', name:'Halloween Party', dateISO:'2025-10-31T23:00:00+01:00', shortDate:'Fr 31 Okt', desc:'Latin Mix • Costume Contest', lineup:'DJ Pepe', prices:'Vorverkauf 5€ • Abendkasse 10€', cover:'hallowe 31.10.jpg',
      ticketUrl:'https://eventfrog.de/de/p/party/disco/halloween-party-7381430034773332317.html' },
    { slug:'last-school-day-2025-12-19', name:'Last School Day 2025 – Spendenparty Abi 2026 (FES)', dateISO:'2025-12-19T22:00:00+01:00', shortDate:'Fr 19 Dez', desc:'Spendenaktion des Abi-Jahrgangs 2026 der FES • Einlass 22:00', lineup:'—', prices:'Ticket 7€ • Mindestalter 16', cover:'Black Party Night Club Dj Flyer.png',
      ticketUrl:'https://eventfrog.de/de/p/party/disco/last-school-day-2025-7383798159095412970.html' }
  ];
  const recurring = [
    { slug:'karaoke-night', name:'Karaoke Night', when:'Jeden Donnerstag', time:'21:30 – 02:00', desc:'Eintritt frei • Die Bühne gehört dir!', lineup:'Open Mic • Host Afterlux', prices:'Free Entry', cover:'karaoke.jpg' },
  ];

  const $ = s => document.querySelector(s);
  const cards = $('#event-cards');
  const recWrap = $('#recurring-cards');

  (function fillMonths(){
    const months = [...new Set(eventi.map(e =>
      new Date(e.dateISO).toLocaleString('de-DE',{month:'long',year:'numeric'})
    ))];
    const sel=$('#month'); months.forEach(m=>{const o=document.createElement('option');o.textContent=m;o.value=m;sel.appendChild(o);});
    $('#clr').addEventListener('click', ()=>{ $('#q').value=''; $('#month').value=''; filter(); });
  })();

  function cardHTML(ev){
    return `
    <article class="card">
      <img src="${encodeURI(ev.cover)}" alt="${ev.name}" loading="lazy" decoding="async">
      <div class="content">
        <div class="pill">${ev.shortDate}</div>
        <h3 style="color:#fff">${ev.name}</h3>
        <p class="muted">${ev.desc ?? ''}</p>
        <p class="muted" style="font-size:12px">${new Date(ev.dateISO).toLocaleString('de-DE',{weekday:'short',hour:'2-digit',minute:'2-digit'})}</p>
        <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
          <a class="btn event-detail-link" href="#evento/${ev.slug}" data-slug="${ev.slug}" aria-label="Details zu ${ev.name}">Details & Reservieren</a>
          ${ev.ticketUrl ? `<a class="btn ghost" href="${ev.ticketUrl}" target="_blank" rel="noopener" aria-label="Tickets für ${ev.name} kaufen">Tickets</a>` : ``}
        </div>
      </div>
    </article>`;
  }

  const now = new Date();
  const upcoming = eventi.filter(e => new Date(e.dateISO) > now).sort((a,b)=>new Date(a.dateISO)-new Date(b.dateISO));

  function render(list){
    cards.innerHTML = list.length ? list.map(cardHTML).join('') : `<p class="muted">Keine geplanten Events mit Datum.</p>`;
  }
  render(upcoming);

  recWrap.innerHTML = recurring.map(ev => `
    <article class="card">
      ${ev.cover ? `<img src="${encodeURI(ev.cover)}" alt="${ev.name}" loading="lazy">` : ``}
      <div class="content">
        <div class="pill">${ev.when} • ${ev.time}</div>
        <h3 style="color:#fff">${ev.name}</h3>
        <p class="muted">${ev.desc ?? ''}</p>
        <div style="margin-top:8px">
          <a class="btn recurring-detail-link" href="#evento/${ev.slug}" data-slug="${ev.slug}" aria-label="Details zu ${ev.name}">Details & Reservieren</a>
        </div>
      </div>
    </article>
  `).join('');

  function filter(){
    const q=$('#q').value.toLowerCase().trim();
    const m=$('#month').value;
    const list = upcoming.filter(e=>{
      const mm=new Date(e.dateISO).toLocaleString('de-DE',{month:'long',year:'numeric'});
      const txt=(e.name+' '+(e.desc||'')+' '+(e.lineup||'')).toLowerCase();
      return (!q||txt.includes(q)) && (!m||m===mm);
    });
    render(list);
  }
  $('#q').addEventListener('input', filter);
  $('#month').addEventListener('change', filter);

  /* COUNTDOWN */
  const cdWrap = document.getElementById('countdown');
  if (upcoming.length){
    const target = new Date(upcoming[0].dateISO).getTime();
    const dEl = document.getElementById('cd-d'), hEl=document.getElementById('cd-h'), mEl=document.getElementById('cd-m'), sEl=document.getElementById('cd-s');
    const tick=()=>{
      const t = target - Date.now();
      if (t<=0){dEl.textContent='0';hEl.textContent='00';mEl.textContent='00';sEl.textContent='00';return;}
      const d=Math.floor(t/86400000), h=Math.floor((t%86400000)/3600000),
            m=Math.floor((t%3600000)/60000), s=Math.floor((t%60000)/1000);
      dEl.textContent=d; hEl.textContent=String(h).padStart(2,'0');
      mEl.textContent=String(m).padStart(2,'0'); sEl.textContent=String(s).padStart(2,'0');
    }; tick(); setInterval(tick,1000); cdWrap.hidden=false;
  }

  /* MODAL */
  let currentDetailSlug = null;
  const overlay = document.getElementById('event-detail');

  const findAny = slug =>
    upcoming.find(e=>e.slug===slug) ||
    eventi.find(e=>e.slug===slug)   ||
    recurring.find(e=>e=>e.slug===slug);

  function findAny(slug){
    return upcoming.find(e=>e.slug===slug) || eventi.find(e=>e.slug===slug) || recurring.find(e=>e.slug===slug);
  }

  const fillDetail = ev => {
    document.getElementById('detail-title').textContent = ev.name;
    document.getElementById('detail-name').textContent  = ev.name;
    document.getElementById('detail-date').textContent  = ev.dateISO
      ? new Date(ev.dateISO).toLocaleString('it-IT',{weekday:'long',day:'2-digit',month:'long',hour:'2-digit',minute:'2-digit'})
      : `${ev.when} • ${ev.time}`;
    document.getElementById('detail-desc').textContent   = ev.desc || '—';
    document.getElementById('detail-lineup').textContent = ev.lineup || '—';
    document.getElementById('detail-prices').textContent = ev.prices || '—';
    document.getElementById('detail-cover').style.backgroundImage = ev.cover ? `url(${encodeURI(ev.cover)})` : '';
  };

  function openDetail(slug){
    const ev = findAny(slug);
    if (!ev) return;
    currentDetailSlug = slug;
    fillDetail(ev);
    overlay.classList.add('show');
  }
  const closeDetail = ()=> overlay.classList.remove('show');

  document.addEventListener('click', e=>{
    const a = e.target.closest('.event-detail-link, .recurring-detail-link');
    if(a){ e.preventDefault(); openDetail(a.getAttribute('data-slug')); }
    if(e.target===overlay) closeDetail();
  });
  window.addEventListener('keydown', e=>{ if(e.key==='Escape') closeDetail(); });

  function handleHash(){
    if(location.hash.startsWith('#evento/')){
      const slug = location.hash.split('/')[1]; if(slug) openDetail(slug);
    }
  }
  handleHash();
  window.addEventListener('hashchange', handleHash);

  /* PRENOTAZIONI */
  function ensureEventSelectOptions(){
    const sel = document.getElementById('pr-event');
    if (!sel) return;
    if (sel.options.length > 1) return;
    const list = [...upcoming.map(e=>e.name), ...recurring.map(e=>e.name+' (wiederkehrend)')];
    (list.length?list:['Karaoke Night (wiederkehrend)']).forEach(n=>{
      const o=document.createElement('option'); o.value=n; o.textContent=n; sel.appendChild(o);
    });
  }
  function showBookingSectionFrom(slug){
    const ev = findAny(slug);
    const sec = document.getElementById('prenotazioni');
    if (!sec) return;
    sec.style.setProperty('display','block','important');
    ensureEventSelectOptions();

    const sel = document.getElementById('pr-event');
    if (sel && ev){ sel.value = ev.dateISO ? ev.name : `${ev.name} (wiederkehrend)`; }
    const dateInput = document.getElementById('pr-data');
    if (dateInput){
      if (ev && ev.dateISO){
        const d = new Date(ev.dateISO);
        const yyyy=d.getFullYear(), mm=String(d.getMonth()+1).padStart(2,'0'), dd=String(d.getDate()).padStart(2,'0');
        dateInput.value = `${yyyy}-${mm}-${dd}`;
      } else { dateInput.value = ''; }
    }
    closeDetail();
    sec.scrollIntoView({behavior:'smooth',block:'start'});
  }
  document.addEventListener('click', e=>{
    if (e.target && e.target.id === 'open-booking'){
      showBookingSectionFrom(currentDetailSlug);
    }
  });

  function isValid(){
    const n=document.getElementById('pr-nome').value.trim();
    const t=document.getElementById('pr-tel').value.trim();
    if(!n||!t){ alert('Bitte Name und Telefon angeben.'); return false; }
    return true;
  }
  ['pr-nome','pr-tel','pr-email'].forEach(id=>{
    const el=document.getElementById(id);
    el.value = localStorage.getItem(id)||'';
    el.addEventListener('change',()=>localStorage.setItem(id,el.value));
  });

  function buildMsg(){
    const nome = document.getElementById('pr-nome').value.trim();
    const tel  = document.getElementById('pr-tel').value.trim();
    const mail = document.getElementById('pr-email').value.trim();
    const data = document.getElementById('pr-data').value;
    const evento = document.getElementById('pr-event').value;
    const lounge = document.getElementById('pr-lounge').value;
    const persone= document.getElementById('pr-persone').value;
    const note   = document.getElementById('pr-note').value.trim();
    return [
      'Hi Afterlux! Ich möchte eine Lounge reservieren.',
      evento ? `Event: ${evento}` : 'Event: (noch offen)',
      data ? `Datum: ${data}` : null,
      `Lounge: ${lounge}`, `Personen: ${persone}`,
      nome ? `Name: ${nome}` : null, tel ? `Telefon: ${tel}` : null, mail ? `E-Mail: ${mail}` : null,
      note ? `Notizen: ${note}` : null
    ].filter(Boolean).join('\n');
  }
  document.getElementById('btn-wa')?.addEventListener('click', ()=>{
    if(!isValid()) return;
    window.open(`https://wa.me/4915738465393?text=${encodeURIComponent(buildMsg())}`,'_blank');
  });
  document.getElementById('btn-mail')?.addEventListener('click', ()=>{
    if(!isValid()) return;
    location.href = `mailto:afterlux.loerrach@gmail.com?subject=${encodeURIComponent('Lounge-Reservierung - Afterlux')}&body=${encodeURIComponent(buildMsg())}`;
  });

  /* CONTATTI toggle */
  const contatti = document.getElementById('contatti');
  function openContatti(){
    contatti.classList.add('open');
    contatti.setAttribute('aria-expanded','true');
    contatti.scrollIntoView({behavior:'smooth',block:'start'});
  }
  function toggleContatti(){
    const willOpen = !contatti.classList.contains('open');
    contatti.classList.toggle('open', willOpen);
    contatti.setAttribute('aria-expanded', String(willOpen));
    if (willOpen) contatti.scrollIntoView({behavior:'smooth',block:'start'});
  }
  contatti.querySelector('h2').addEventListener('click', toggleContatti);
  contatti.querySelector('h2').addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' ') { e.preventDefault(); toggleContatti(); } });

  /* JSON-LD SEO */
  (function(){
    const base = new URL('.', location.href).href;
    const abs = p => { try { return new URL(p, base).href; } catch(e){ return p; } };
    const addLD = obj => { const s=document.createElement('script'); s.type='application/ld+json'; s.textContent = JSON.stringify(obj); document.head.appendChild(s); };

    addLD({
      "@context":"https://schema.org","@type":"Organization","name":"Afterlux Club",
      "url": location.origin + location.pathname,
      "logo": abs("afterluxluna.png"),
      "sameAs":["https://www.instagram.com/afterlux_club/"],
      "address":{"@type":"PostalAddress","streetAddress":"Teicherstrasse 14","postalCode":"79539","addressLocality":"Lörrach","addressCountry":"DE"},
      "telephone":"+49 1573 8465393"
    });

    const FREE_RE = /(gratis|free)/i;
    function buildOffers(ev){
      const prices = ev.prices || ev.desc || '';
      if (FREE_RE.test(prices)) {
        const o={"@type":"Offer","price":"0","priceCurrency":"EUR","availability":"https://schema.org/InStock","isAccessibleForFree":true};
        if (ev.ticketUrl) o.url = ev.ticketUrl;
        return o;
      }
      const matches=(prices.match(/(\d+[.,]?\d*)\s*€/g)||[]).map(x=>x.replace(/[^\d.,]/g,'').replace(',','.'));
      if (matches.length===0 && ev.ticketUrl){ return {"@type":"Offer","priceCurrency":"EUR","availability":"https://schema.org/InStock","url":ev.ticketUrl}; }
      if (matches.length===1){ return {"@type":"Offer","price":matches[0],"priceCurrency":"EUR","availability":"https://schema.org/InStock","url":ev.ticketUrl||location.href}; }
      return matches.map(p=>({"@type":"Offer","price":p,"priceCurrency":"EUR","availability":"https://schema.org/InStock","url":ev.ticketUrl||location.href}));
    }
    eventi.forEach(ev=>{
      const ld={"@context":"https://schema.org","@type":"Event","name":ev.name,"startDate":ev.dateISO,
        "eventStatus":"https://schema.org/EventScheduled","eventAttendanceMode":"https://schema.org/OfflineEventAttendanceMode",
        "image":[ abs(encodeURI(ev.cover)) ],"description":ev.desc||"",
        "location":{"@type":"Place","name":"Afterlux Club","address":{"@type":"PostalAddress","streetAddress":"Teicherstrasse 14","addressLocality":"Lörrach","postalCode":"79539","addressCountry":"DE"}},
        "organizer":{"@type":"Organization","name":"Afterlux Club","url": location.origin + location.pathname}
      };
      const offers=buildOffers(ev); if(offers) ld.offers=offers;
      if (ev.lineup && ev.lineup!=='—'){ ld.performer=[{"@type":"PerformingGroup","name":ev.lineup}]; }
      addLD(ld);
    });
  })();
</script>
</body>
</html>
